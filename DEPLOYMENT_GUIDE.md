# Lawrei Beauty Website - Deployment Guide

## ğŸš€ Quick Deploy to Render (Backend + Frontend)

### 1. Render Backend Deployment

1. **Fork/Clone** this repository to your GitHub account
2. **Connect to Render**:
   - Go to [render.com](https://render.com)
   - Create new Web Service
   - Connect your GitHub repository
   - Use these settings:
     - **Name**: `lawrei-beauty-backend`
     - **Environment**: `Node`
     - **Build Command**: `npm ci && npm run build`
     - **Start Command**: `npm start`
     - **Plan**: Free

3. **Environment Variables** (set these in Render dashboard):
   ```
   NODE_ENV=production
   DATABASE_URL=your-neon-database-url (optional for now)
   SESSION_SECRET=your-random-secret-string
   CORS_ORIGIN=https://your-frontend-domain.vercel.app
   ```

4. **Deploy** and wait for build to complete

### 2. Vercel Frontend Deployment

1. **Connect to Vercel**:
   - Go to [vercel.com](https://vercel.com)
   - Import your GitHub repository
   - Use these settings:
     - **Framework Preset**: Vite
     - **Build Command**: `npm run build:frontend`
     - **Output Directory**: `dist/public`
     - **Install Command**: `npm install`

2. **Environment Variables** (set these in Vercel dashboard):
   ```
   VITE_API_URL=https://your-backend-name.onrender.com
   ```

3. **Deploy** and wait for build to complete

## ğŸ”§ What Was Fixed

### Build Issues Resolved:
- âœ… **esbuild moved to dependencies** - Now available during production builds
- âœ… **Build scripts reorganized** - Proper separation of frontend/backend builds
- âœ… **Missing nanoid dependency** - Added to package.json
- âœ… **Server binding fixed** - Changed from localhost to 0.0.0.0 for production

### Configuration Issues Resolved:
- âœ… **Vite config optimized** - Proper build output directory
- âœ… **Client package.json created** - Helps with deployment platforms
- âœ… **Health endpoint exists** - Render health checks will pass

## ğŸ“ Project Structure

```
lawrei-beauty-website/
â”œâ”€â”€ client/                 # React frontend
â”‚   â”œâ”€â”€ src/               # Source code
â”‚   â”œâ”€â”€ index.html         # Entry point
â”‚   â””â”€â”€ package.json       # Frontend dependencies
â”œâ”€â”€ server/                 # Express backend
â”‚   â”œâ”€â”€ index.ts           # Server entry point
â”‚   â”œâ”€â”€ routes.ts          # API routes
â”‚   â””â”€â”€ vite.ts            # Vite integration
â”œâ”€â”€ shared/                 # Shared schemas/types
â”œâ”€â”€ dist/                   # Build output
â”‚   â””â”€â”€ public/            # Frontend build files
â””â”€â”€ package.json            # Root dependencies & scripts
```

## ğŸš¨ Common Issues & Solutions

### Render Build Fails:
- **Error**: `esbuild: not found`
- **Solution**: âœ… Fixed - esbuild now in dependencies

### Vercel Build Fails:
- **Error**: `Missing script: "build:frontend"`
- **Solution**: âœ… Fixed - Script now exists and works

### Server Won't Start:
- **Error**: Connection refused
- **Solution**: âœ… Fixed - Server now binds to 0.0.0.0

### Missing Dependencies:
- **Error**: `Cannot find module 'nanoid'`
- **Solution**: âœ… Fixed - Added to package.json

## ğŸ”„ Build Process

1. **Frontend Build** (`npm run build:frontend`):
   - Vite builds React app
   - Outputs to `dist/public/`

2. **Backend Build** (`npm run build:backend`):
   - esbuild bundles Express server
   - Outputs to `dist/`

3. **Full Build** (`npm run build`):
   - Runs both builds in sequence

## ğŸŒ Environment Variables

### Required for Production:
- `NODE_ENV=production`
- `PORT` (auto-set by Render)
- `SESSION_SECRET` (auto-generated by Render)

### Optional:
- `DATABASE_URL` (for future database integration)
- `CORS_ORIGIN` (for frontend domain)

## ğŸ“Š Monitoring & Debugging

### Health Check Endpoints:
- `/health` - Basic health status
- `/db-test` - Database connection test

### Logs:
- Check Render logs for backend issues
- Check Vercel logs for frontend issues
- Server logs show API request details

## ğŸš€ Next Steps After Deployment

1. **Test the API**:
   - Visit `/health` endpoint
   - Test booking form submission
   - Verify admin login works

2. **Connect Frontend to Backend**:
   - Update `VITE_API_URL` in Vercel
   - Test form submissions

3. **Database Integration** (Future):
   - Set up Neon database
   - Update `DATABASE_URL`
   - Run migrations

## ğŸ“ Support

If you encounter issues:
1. Check the logs in Render/Vercel dashboards
2. Verify environment variables are set correctly
3. Ensure all dependencies are installed
4. Check that the build process completes successfully

---

**Happy Deploying! ğŸ‰**
